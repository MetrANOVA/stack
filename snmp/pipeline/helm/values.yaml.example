# Default values for metranova-snmp-pipeline

# Global settings
global:
  imagePullSecrets: []

# Image settings
image:
  repository: ghcr.io/metranova/pipeline
  pullPolicy: IfNotPresent
  tag: "latest"

# Data SNMP service configuration
dataSnmp:
  enabled: true
  replicaCount: 1
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 256Mi
  env:
    pipelineYaml: /app/pipelines/data_snmp.yml
    kafkaTopic: metranova_snmp
    clickhouseIfTrafficTable: data_interface_traffic

# Metadata CAIDA Org AS service configuration
metadataCaidaOrgAs:
  enabled: true
  replicaCount: 1
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  env:
    pipelineYaml: /app/pipelines/metadata_caida_org_as.yml
    clickhouseAsMetadataExtensions: peeringdb
    clickhouseMetadataForceUpdate: "false"
    caidaOrgAsConsumerAs2orgFile: /app/caches/caida_as_org2info.jsonl
    caidaOrgAsConsumerPeeringdbFile: /app/caches/caida_peeringdb.json
    caidaOrgAsConsumerCustomAsFile: /app/caches/custom_as_additions.yml
    caidaOrgAsConsumerCustomOrgFile: /app/caches/custom_org_additions.yml
    caidaOrgAsConsumerUpdateInterval: "86400"

# Metadata File Export service configuration
metadataFileExport:
  enabled: true
  replicaCount: 1
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  env:
    pipelineYaml: /app/pipelines/metadata_file_export.yml
    clickhouseMetadataForceUpdate: "false"
    fileConsumerFilePaths: /app/conf/meta_interface.yml,/app/conf/meta_device.yml,/app/conf/meta_circuit.yml
    fileConsumerUpdateInterval: "600"

# Base configuration (shared across all services)
config:
  debug: "false"
  
  # Kafka configuration
  kafka:
    bootstrapServers: kafka:9092
    consumerGroup: metranova_pipeline
    ssl:
      enabled: true
      caLocation: /app/conf/certificates/kafka_ca.crt
      certificateLocation: /app/conf/certificates/kafka_user.crt
      keyLocation: /app/conf/certificates/kafka_user.key
      keyPassword: "CHANGEME"
  
  # ClickHouse configuration
  clickhouse:
    host: clickhouse
    port: 9440
    database: metranova
    username: pipeline_user
    password: "CHANGEME"
    batchSize: "10000"
    batchTimeout: "5"
    
    # Metadata tables
    tables:
      interface: meta_interface
      device: meta_device
      organization: meta_organization
      circuit: meta_circuit
      as: meta_as
  
  # Redis configuration
  redis:
    host: metranova-snmp-metranova-snmp-pipeline-redis
    port: 6379
    db: 0

# Certificates
certificates:
  # Create ConfigMap/Secret for certificates
  # Mount your certificate files here
  existingSecret: ""  # Name of existing secret containing certificates
  # If existingSecret is not provided, certificates will be created from files
  kafka:
    ca: ""
    cert: ""
    key: ""

# Cache files configuration
caches:
  # Existing PVC for cache files
  existingPvc: ""
  # If existingPvc is not provided, a new PVC will be created
  storageSize: 1Gi
  storageClassName: ""

# Redis configuration
redis:
  enabled: true
  image:
    repository: redis
    tag: "8.2.1"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 6379
  persistence:
    enabled: true
    existingPvc: ""
    storageSize: 1Gi
    storageClassName: ""
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

# Configuration files
configFiles:
  # Existing ConfigMap for configuration files
  existingConfigMap: ""
  # If existingConfigMap is not provided, files will be mounted from local conf/ directory
  metaInterface: ""
  metaDevice: ""
  metaCircuit: ""
  telegrafMappings: ""
  customASAdditions: ""
  customOrgAdditions: ""

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Pod annotations
podAnnotations: {}

# Pod security context
podSecurityContext: {}
  # fsGroup: 2000

# Security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}
